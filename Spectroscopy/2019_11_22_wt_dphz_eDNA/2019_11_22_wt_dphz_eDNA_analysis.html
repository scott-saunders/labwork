<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Scott Saunders" />


<title>WT vs ∆PHZ* eDNA, with TOTO</title>

<script src="2019_11_22_wt_dphz_eDNA_analysis_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="2019_11_22_wt_dphz_eDNA_analysis_files/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="2019_11_22_wt_dphz_eDNA_analysis_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="2019_11_22_wt_dphz_eDNA_analysis_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="2019_11_22_wt_dphz_eDNA_analysis_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="2019_11_22_wt_dphz_eDNA_analysis_files/navigation-1.1/tabsets.js"></script>
<script src="2019_11_22_wt_dphz_eDNA_analysis_files/navigation-1.1/codefolding.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>




</head>

<body>


<div class="container-fluid main-container">




<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">WT vs ∆PHZ* eDNA, with TOTO</h1>
<h4 class="author">Scott Saunders</h4>
<h4 class="date">11_22_19</h4>

</div>

<div id="TOC">
<ul>
<li><a href="#intro">Intro</a></li>
<li><a href="#methods">Methods</a></li>
<li><a href="#results">Results</a><ul>
<li><a href="#calibration-curve">Calibration curve</a></li>
<li><a href="#phz">∆phz*</a></li>
<li><a href="#wt">WT</a></li>
<li><a href="#comparison">Comparison</a></li>
</ul></li>
</ul>
</div>

<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(cowplot)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(viridis)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">library</span>(kableExtra)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">library</span>(modelr)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw">library</span>(broom)</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1-9" data-line-number="9">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">tidy.opts=</span><span class="kw">list</span>(<span class="dt">width.cutoff=</span><span class="dv">60</span>),<span class="dt">tidy=</span><span class="ot">TRUE</span>, <span class="dt">echo =</span> <span class="ot">TRUE</span>, <span class="dt">message=</span><span class="ot">FALSE</span>, <span class="dt">warning=</span><span class="ot">FALSE</span>, <span class="dt">fig.align=</span><span class="st">&quot;center&quot;</span>)</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="kw">source</span>(<span class="st">&quot;../../IDA/tools/plotting_tools.R&quot;</span>)</a>
<a class="sourceLine" id="cb1-12" data-line-number="12"></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="kw">theme_set</span>(<span class="kw">theme_1</span>())</a></code></pre></div>
<div id="intro" class="section level1">
<h1>Intro</h1>
<p>Repeat measurement of eDNA in colonies, but compare WT and ∆phz.</p>
</div>
<div id="methods" class="section level1">
<h1>Methods</h1>
<p>Six ∆phz* and six WT colony biofilms were grown for four days, as usual. They were resuspended and measured for eDNA using the TOTO plate reader assay as described previously. The dPHZ colonies were a little harder to resuspend, so they received additional vortexing and pipetting.</p>
<p>Basically I acquired 4 plate reader measurements:</p>
<ol style="list-style-type: decimal">
<li>The standard curve with ctDNA</li>
<li>WT colonies (+ standard curve)</li>
<li>∆phz* colonies (+ standard curve)</li>
<li>Remeasure with ctDNA added to standard wells and first replicate of WT and dPHZ measurements (Wells A1-12, B1-6, E1-6)</li>
</ol>
<p>The standard curve was made by taking a stock of ctDNA (2mg/mL) and diluting 1:10. That was then used as the highest concentration and was diluted 2x consecutively to fill 12 wells.</p>
<p>The ctDNA added at the end was 2uL of a 1:25 dilution of the 2mg/mL ctDNA stock, because I estimated that should be in the right range to see approximately a doubling of fluorescence.</p>
</div>
<div id="results" class="section level1">
<h1>Results</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">df_meta &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/2019_11_22_well_metadata.csv&quot;</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">df_std &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/2019_11_22_std_preCTdna.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;Well&quot;</span>, </a>
<a class="sourceLine" id="cb2-4" data-line-number="4">    <span class="dt">value =</span> <span class="st">&quot;FluorInt&quot;</span>, <span class="op">-</span>wavelength) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">read =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">df_wt &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/2019_11_22_std_WT_preCTdna.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="st">    </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;Well&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;FluorInt&quot;</span>, <span class="op">-</span>wavelength) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">read =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb2-9" data-line-number="9"></a>
<a class="sourceLine" id="cb2-10" data-line-number="10">df_dphz &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/2019_11_22_dphz_preCTdna.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="st">    </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;Well&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;FluorInt&quot;</span>, <span class="op">-</span>wavelength) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">read =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb2-13" data-line-number="13"></a>
<a class="sourceLine" id="cb2-14" data-line-number="14">df_ctDNA &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/2019_11_22_std_wt_dphz_postCTdna.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="st">    </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;Well&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;FluorInt&quot;</span>, <span class="op">-</span>wavelength) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">read =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb2-17" data-line-number="17"></a>
<a class="sourceLine" id="cb2-18" data-line-number="18">df_all &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(df_std, df_wt, df_dphz, df_ctDNA)</a>
<a class="sourceLine" id="cb2-19" data-line-number="19"></a>
<a class="sourceLine" id="cb2-20" data-line-number="20">df_all_meta &lt;-<span class="st"> </span><span class="kw">left_join</span>(df_all, df_meta, <span class="dt">by =</span> <span class="kw">c</span>(<span class="dt">Well =</span> <span class="st">&quot;well&quot;</span>))</a></code></pre></div>
<div id="calibration-curve" class="section level2">
<h2>Calibration curve</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">ggplot</span>(df_all_meta <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(strain <span class="op">==</span><span class="st"> &quot;std&quot;</span> <span class="op">&amp;</span><span class="st"> </span>wavelength <span class="op">==</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="st">    </span><span class="dv">535</span>), <span class="kw">aes</span>(<span class="dt">x =</span> well_std_conc, <span class="dt">y =</span> FluorInt, <span class="dt">color =</span> <span class="kw">factor</span>(read))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;nls&quot;</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="st">    </span>max <span class="op">*</span><span class="st"> </span>(x<span class="op">^</span>hill)<span class="op">/</span>((Kd<span class="op">^</span>hill) <span class="op">+</span><span class="st"> </span>(x<span class="op">^</span>hill)), <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">start =</span> <span class="kw">c</span>(<span class="dt">max =</span> <span class="dv">60000</span>, </a>
<a class="sourceLine" id="cb3-5" data-line-number="5">    <span class="dt">hill =</span> <span class="dv">1</span>, <span class="dt">Kd =</span> <span class="dv">5</span>)), <span class="dt">se =</span> F)</a></code></pre></div>
<p><img src="2019_11_22_wt_dphz_eDNA_analysis_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">df_all_meta <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(strain <span class="op">==</span><span class="st"> &quot;std&quot;</span> <span class="op">&amp;</span><span class="st"> </span>wavelength <span class="op">==</span><span class="st"> </span><span class="dv">535</span> <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="st">    </span>read <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## # A tibble: 12 x 10
##    wavelength Well  FluorInt  read strain toto_added ctDNA_added
##         &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;lgl&gt;      &lt;lgl&gt;      
##  1        535 A1       55732     1 std    TRUE       TRUE       
##  2        535 A2       57010     1 std    TRUE       TRUE       
##  3        535 A3       52506     1 std    TRUE       TRUE       
##  4        535 A4       43673     1 std    TRUE       TRUE       
##  5        535 A5       29038     1 std    TRUE       TRUE       
##  6        535 A6       19617     1 std    TRUE       TRUE       
##  7        535 A7       11332     1 std    TRUE       TRUE       
##  8        535 A8        5564     1 std    TRUE       TRUE       
##  9        535 A9        2778     1 std    TRUE       TRUE       
## 10        535 A10       1406     1 std    TRUE       TRUE       
## 11        535 A11        682     1 std    TRUE       TRUE       
## 12        535 A12        774     1 std    TRUE       TRUE       
## # … with 3 more variables: well_std_conc &lt;dbl&gt;, bio_rep &lt;dbl&gt;,
## #   tech_rep &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">model_toto &lt;-<span class="st"> </span><span class="kw">nls</span>(<span class="dt">data =</span> df_all_meta <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(strain <span class="op">==</span><span class="st"> &quot;std&quot;</span> <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">    </span>wavelength <span class="op">==</span><span class="st"> </span><span class="dv">535</span> <span class="op">&amp;</span><span class="st"> </span>read <span class="op">==</span><span class="st"> </span><span class="dv">1</span>), <span class="dt">formula =</span> FluorInt <span class="op">~</span><span class="st"> </span>max <span class="op">*</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="st">    </span>(well_std_conc<span class="op">^</span>hill)<span class="op">/</span>((Kd<span class="op">^</span>hill) <span class="op">+</span><span class="st"> </span>(well_std_conc<span class="op">^</span>hill)), </a>
<a class="sourceLine" id="cb6-4" data-line-number="4">    <span class="dt">start =</span> <span class="kw">c</span>(<span class="dt">max =</span> <span class="dv">60000</span>, <span class="dt">hill =</span> <span class="dv">1</span>, <span class="dt">Kd =</span> <span class="dv">5</span>))</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="kw">tidy</span>(model_toto, <span class="dt">conf.int =</span> T)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 7
##   term  estimate std.error statistic  p.value conf.low conf.high
##   &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 max   59842.   1473.          40.6 1.65e-11 56876.    63348.  
## 2 hill      1.19    0.0780      15.3 9.49e- 8     1.03      1.38
## 3 Kd        2.87    0.211       13.6 2.60e- 7     2.47      3.40</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">confint_toto &lt;-<span class="st"> </span><span class="kw">tidy</span>(model_toto, <span class="dt">conf.int =</span> T) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(term <span class="op">==</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="st">    &quot;Kd&quot;</span>)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"></a>
<a class="sourceLine" id="cb8-4" data-line-number="4">pred_toto &lt;-<span class="st"> </span>df_all_meta <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(strain <span class="op">==</span><span class="st"> &quot;std&quot;</span> <span class="op">&amp;</span><span class="st"> </span>wavelength <span class="op">==</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="st">    </span><span class="dv">535</span> <span class="op">&amp;</span><span class="st"> </span>read <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">max =</span> <span class="kw">coef</span>(model_toto)[<span class="dv">1</span>], <span class="dt">hill =</span> <span class="kw">coef</span>(model_toto)[<span class="dv">2</span>], </a>
<a class="sourceLine" id="cb8-6" data-line-number="6">    <span class="dt">kd =</span> <span class="kw">coef</span>(model_toto)[<span class="dv">3</span>]) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">kd_low =</span> confint_toto<span class="op">$</span>conf.low, </a>
<a class="sourceLine" id="cb8-7" data-line-number="7">    <span class="dt">kd_high =</span> confint_toto<span class="op">$</span>conf.high) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">pred =</span> max <span class="op">*</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="st">    </span>(well_std_conc<span class="op">^</span>hill)<span class="op">/</span>((kd<span class="op">^</span>hill) <span class="op">+</span><span class="st"> </span>(well_std_conc<span class="op">^</span>hill))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">pred_low =</span> max <span class="op">*</span><span class="st"> </span>(well_std_conc<span class="op">^</span>hill)<span class="op">/</span>((kd_low<span class="op">^</span>hill) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="st">        </span>(well_std_conc<span class="op">^</span>hill))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">pred_high =</span> max <span class="op">*</span><span class="st"> </span>(well_std_conc<span class="op">^</span>hill)<span class="op">/</span>((kd_high<span class="op">^</span>hill) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="st">    </span>(well_std_conc<span class="op">^</span>hill)))</a>
<a class="sourceLine" id="cb8-12" data-line-number="12"></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="kw">ggplot</span>(pred_toto, <span class="kw">aes</span>(<span class="dt">x =</span> well_std_conc, <span class="dt">y =</span> FluorInt)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> pred_low, </a>
<a class="sourceLine" id="cb8-14" data-line-number="14">    <span class="dt">ymax =</span> pred_high), <span class="dt">fill =</span> <span class="st">&quot;light gray&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> pred), </a>
<a class="sourceLine" id="cb8-15" data-line-number="15">    <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>)</a></code></pre></div>
<p><img src="2019_11_22_wt_dphz_eDNA_analysis_files/figure-html/unnamed-chunk-2-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">ggplot</span>(pred_toto, <span class="kw">aes</span>(<span class="dt">x =</span> well_std_conc, <span class="dt">y =</span> FluorInt)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> pred_low, </a>
<a class="sourceLine" id="cb9-2" data-line-number="2">    <span class="dt">ymax =</span> pred_high), <span class="dt">fill =</span> <span class="st">&quot;light gray&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> pred), </a>
<a class="sourceLine" id="cb9-3" data-line-number="3">    <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_log10</span>()</a></code></pre></div>
<p><img src="2019_11_22_wt_dphz_eDNA_analysis_files/figure-html/unnamed-chunk-2-3.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">ggplot</span>(pred_toto <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(FluorInt <span class="op">&lt;</span><span class="st"> </span><span class="dv">30000</span>), <span class="kw">aes</span>(<span class="dt">x =</span> well_std_conc, </a>
<a class="sourceLine" id="cb10-2" data-line-number="2">    <span class="dt">y =</span> FluorInt)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> pred_low, <span class="dt">ymax =</span> pred_high), </a>
<a class="sourceLine" id="cb10-3" data-line-number="3">    <span class="dt">fill =</span> <span class="st">&quot;light gray&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> pred), <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>)</a></code></pre></div>
<p><img src="2019_11_22_wt_dphz_eDNA_analysis_files/figure-html/unnamed-chunk-2-4.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="phz" class="section level2">
<h2>∆phz*</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">ggplot</span>(df_all_meta <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(strain <span class="op">==</span><span class="st"> &quot;dPHZ&quot;</span> <span class="op">&amp;</span><span class="st"> </span>wavelength <span class="op">==</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">    </span><span class="dv">535</span>), <span class="kw">aes</span>(<span class="dt">x =</span> bio_rep, <span class="dt">y =</span> FluorInt, <span class="dt">color =</span> <span class="kw">factor</span>(read), </a>
<a class="sourceLine" id="cb11-3" data-line-number="3">    <span class="dt">shape =</span> ctDNA_added)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>tech_rep)</a></code></pre></div>
<p><img src="2019_11_22_wt_dphz_eDNA_analysis_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="wt" class="section level2">
<h2>WT</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">ggplot</span>(df_all_meta <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(strain <span class="op">==</span><span class="st"> &quot;WT&quot;</span> <span class="op">&amp;</span><span class="st"> </span>wavelength <span class="op">==</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="st">    </span><span class="dv">535</span>), <span class="kw">aes</span>(<span class="dt">x =</span> bio_rep, <span class="dt">y =</span> FluorInt, <span class="dt">color =</span> <span class="kw">factor</span>(read), </a>
<a class="sourceLine" id="cb12-3" data-line-number="3">    <span class="dt">shape =</span> ctDNA_added)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>tech_rep)</a></code></pre></div>
<p><img src="2019_11_22_wt_dphz_eDNA_analysis_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="comparison" class="section level2">
<h2>Comparison</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">df_ctDNA_change &lt;-<span class="st"> </span>df_all_meta <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(wavelength <span class="op">==</span><span class="st"> </span><span class="dv">535</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="st">    </span><span class="kw">group_by</span>(strain, tech_rep, bio_rep, ctDNA_added) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">min =</span> <span class="kw">min</span>(FluorInt), </a>
<a class="sourceLine" id="cb13-3" data-line-number="3">    <span class="dt">max =</span> <span class="kw">max</span>(FluorInt)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">range =</span> max <span class="op">-</span><span class="st"> </span>min)</a>
<a class="sourceLine" id="cb13-4" data-line-number="4"></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="kw">ggplot</span>(df_ctDNA_change <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(strain <span class="op">!=</span><span class="st"> &quot;std&quot;</span> <span class="op">&amp;</span><span class="st"> </span>tech_rep <span class="op">&lt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="st">    </span><span class="dv">4</span>), <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(tech_rep), <span class="dt">y =</span> range, <span class="dt">shape =</span> ctDNA_added)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>strain) <span class="op">+</span><span class="st"> </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">21</span>, </a>
<a class="sourceLine" id="cb13-8" data-line-number="8">    <span class="dv">22</span>))</a></code></pre></div>
<p><img src="2019_11_22_wt_dphz_eDNA_analysis_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Interestingly, the initial reading for WT was taken more quickly following incubation with the dye than ∆phz, because I had to restart the ∆phz scan because it was taking too long to re-read the WT samples. Perhaps that is the reason all the WT samples increased greatly between the first and last reads.</p>
<p>I think the safest thing to do (in order to compare WT and ∆phz) would be to take the final reading and ignore the technical replicate that had DNA added.</p>
<p>That still gives us 6 biological replicates and 2 tech. reps to work with.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">ggplot</span>(df_all_meta <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(strain <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;WT&quot;</span>, <span class="st">&quot;dPHZ&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>wavelength <span class="op">==</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="st">    </span><span class="dv">535</span> <span class="op">&amp;</span><span class="st"> </span>read <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">&amp;</span><span class="st"> </span>ctDNA_added <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>toto_added <span class="op">==</span><span class="st"> </span>T), </a>
<a class="sourceLine" id="cb14-3" data-line-number="3">    <span class="kw">aes</span>(<span class="dt">x =</span> strain, <span class="dt">y =</span> FluorInt)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_jitter</span>(<span class="dt">shape =</span> <span class="dv">21</span>, </a>
<a class="sourceLine" id="cb14-4" data-line-number="4">    <span class="dt">height =</span> <span class="dv">0</span>, <span class="dt">width =</span> <span class="fl">0.1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="ot">NA</span>)</a></code></pre></div>
<p><img src="2019_11_22_wt_dphz_eDNA_analysis_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>However, adding ctDNA to WT samples did not increase the signal, whereas for ∆phz* samples it did. This suggests that there may be a further complication where the WT biofilms either inhibit the binding of the dye, or degrade the free ctDNA…</p>
<hr />
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.5.2 (2018-12-20)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Mojave 10.14.6
## 
## Matrix products: default
## BLAS: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] broom_0.5.1       modelr_0.1.2      kableExtra_1.0.1 
##  [4] knitr_1.23        viridis_0.5.1     viridisLite_0.3.0
##  [7] cowplot_0.9.4     forcats_0.3.0     stringr_1.3.1    
## [10] dplyr_0.8.1       purrr_0.2.5       readr_1.3.1      
## [13] tidyr_0.8.2       tibble_2.1.3      ggplot2_3.2.0    
## [16] tidyverse_1.2.1  
## 
## loaded via a namespace (and not attached):
##  [1] tidyselect_0.2.5 xfun_0.7         haven_2.0.0      lattice_0.20-38 
##  [5] colorspace_1.4-0 generics_0.0.2   htmltools_0.3.6  yaml_2.2.0      
##  [9] utf8_1.1.4       rlang_0.4.0      pillar_1.3.1     glue_1.3.1      
## [13] withr_2.1.2      readxl_1.2.0     munsell_0.5.0    gtable_0.2.0    
## [17] cellranger_1.1.0 rvest_0.3.2      evaluate_0.14    labeling_0.3    
## [21] fansi_0.4.0      Rcpp_1.0.1       scales_1.0.0     backports_1.1.3 
## [25] formatR_1.5      webshot_0.5.1    jsonlite_1.6     gridExtra_2.3   
## [29] hms_0.4.2        digest_0.6.18    stringi_1.2.4    grid_3.5.2      
## [33] cli_1.1.0        tools_3.5.2      magrittr_1.5     lazyeval_0.2.1  
## [37] crayon_1.3.4     pkgconfig_2.0.2  MASS_7.3-51.1    xml2_1.2.0      
## [41] lubridate_1.7.4  assertthat_0.2.1 rmarkdown_1.13   httr_1.4.0      
## [45] rstudioapi_0.9.0 R6_2.4.0         nlme_3.1-140     compiler_3.5.2</code></pre>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
