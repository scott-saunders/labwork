<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Psoralen treatment - Non equilibrium #2</title>

<script src="01_17_19_psoralen_nonequil_2_Dap_processing_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="01_17_19_psoralen_nonequil_2_Dap_processing_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="01_17_19_psoralen_nonequil_2_Dap_processing_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="01_17_19_psoralen_nonequil_2_Dap_processing_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="01_17_19_psoralen_nonequil_2_Dap_processing_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="01_17_19_psoralen_nonequil_2_Dap_processing_files/navigation-1.1/tabsets.js"></script>
<script src="01_17_19_psoralen_nonequil_2_Dap_processing_files/navigation-1.1/codefolding.js"></script>
<link href="01_17_19_psoralen_nonequil_2_Dap_processing_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="01_17_19_psoralen_nonequil_2_Dap_processing_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>





<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Psoralen treatment - Non equilibrium #2</h1>
<h3 class="subtitle"><em><span class="math inline">\(D_{ap}\)</span> Processing</em></h3>
<h4 class="date"><em>01_17_19</em></h4>

</div>

<div id="TOC">
<ul>
<li><a href="#import">Import</a><ul>
<li><a href="#swv-data">SWV data</a></li>
<li><a href="#gc-data">GC data</a></li>
</ul></li>
<li><a href="#quantification">Quantification</a><ul>
<li><a href="#control-swv">Control SWV</a></li>
<li><a href="#psoralen-swv">Psoralen SWV</a></li>
<li><a href="#all-gc">All GC</a></li>
</ul></li>
<li><a href="#processed-datasets">Processed Datasets</a><ul>
<li><a href="#d_ap-swv-vs.gc"><span class="math inline">\(D_{ap}\)</span> SWV vs. GC</a></li>
</ul></li>
</ul>
</div>

<pre class="r"><code>library(tidyverse)
library(cowplot)
library(broom) 
library(modelr) 
library(viridis)
library(lubridate)
library(hms)

knitr::opts_chunk$set(tidy.opts=list(width.cutoff=60),tidy=TRUE, echo = TRUE, message=FALSE, warning=FALSE, fig.align=&quot;center&quot;)

source(&quot;../../tools/echem_processing_tools.R&quot;)
source(&quot;../../tools/plotting_tools.R&quot;)

theme_set(theme_1())</code></pre>
<div id="import" class="section level1">
<h1>Import</h1>
<div id="swv-data" class="section level2">
<h2>SWV data</h2>
<p>First let’s import the SWV data from all the runs. Now I’m using the “recursive” option in dir() to look through the whole directory strucutre of the raw data files. This allows me to preserve the file structure, which is nice for humans, but still find all the SWV txt files. This works well because the individual files are still named uniquely.</p>
<pre class="r"><code>#divide swv into rep and subrep and then subtract 1 from rep to match with GC
SWV_file_paths &lt;-  dir(path=&#39;../Data&#39;, pattern = &quot;[SWV]+.+[txt]$&quot;,recursive = T,full.names = T)

SWV_filenames &lt;- basename(SWV_file_paths)

swv_data_cols &lt;-  c(&#39;E&#39;,&#39;i1&#39;,&#39;i2&#39;)

filename_cols = c(&#39;PHZadded&#39;,&#39;treatment&#39;,&#39;reactor&#39;,&#39;run&#39;,&#39;echem&#39;,&#39;rep&#39;)

swv_skip_rows=18
  

swv_data &lt;- echem_import_to_df(filenames = SWV_filenames, 
                                       file_paths = SWV_file_paths, 
                                       data_cols = swv_data_cols, 
                                       skip_rows = swv_skip_rows,
                                       filename_cols = filename_cols,
                                       rep = T) %&gt;% 
  mutate(rep=rep-1)</code></pre>
<p>Ok, let’s see what the electrode 1 transfer data looks like: (remember there was 1 soak scan taken before each transfer)</p>
<pre class="r"><code>ggplot(swv_data %&gt;% filter(electrode==&#39;i1&#39; &amp; reactor==&#39;transfer&#39;), aes(x=E, y=current,color=rep,group=factor(rep)))+geom_path()+
  facet_grid(treatment~run,scales=&#39;free&#39;)+
  scale_color_viridis()</code></pre>
<p><img src="01_17_19_psoralen_nonequil_2_Dap_processing_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;" /> Ok, this is the data I expected.<br />
* First, the panel on the far right incorrectly labeled “SWV” is actually the background scan with 0uM PYO, but I’m not going to worry about that now. * Next, we can see that there’s a big difference between the first 3 psoralen runs and the last 2 (4 &amp; 5). For some reason SWV fast produced signals with very high background, starting at the beginning of the experiment. It might still be possible to background subtract them and make use of them, but they look bad…they don’t change very much over the time course. * After the first 3 attempts, I switched to a modified SWV slow for the final 2 psoralen runs, and the high background signal went away. * The control runs look beautiful! The first 3 had about 15 datapoints to measure <span class="math inline">\(D_{ap}\)</span>, and the last 2 had 60 sequential SWVs to measure <span class="math inline">\(D_m\)</span>.</p>
<p>Now let’s look at the same transfer data for electrode 2:</p>
<pre class="r"><code>ggplot(swv_data %&gt;% filter(electrode==&#39;i2&#39; &amp; reactor==&#39;transfer&#39;), aes(x=E, y=current,color=rep,group=factor(rep)))+geom_path()+
  facet_grid(treatment~run,scales=&#39;free&#39;)+
  scale_color_viridis()</code></pre>
<p><img src="01_17_19_psoralen_nonequil_2_Dap_processing_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /> This is also the data I expected, although I admit it is not ideal: * Runs 4 and 5 from the control and psoralen look acceptable, there are clear peaks that diminish. * Unfortunately for runs 1-3 the peaks do not decay, but instead shift and stay relatively constant. Previously, I interpreted this to mean that there is some buildup/reaction that occurs at the collector electrode during GC. Performing the SWV scan immediately after the reductive GC sweep reveals this unexpected product. It is unclear if this is PYO that has built up and for some reason has a shifted peak, or some other side reaction. I do not know how to deal with this, other than hope that it does not affect the reasonable signal measured at electrode 1…</p>
<p>Here’s a closer look at the psoralen SWVs from runs 4 and 5 (electrode 1):</p>
<pre class="r"><code>ggplot(swv_data %&gt;% filter(electrode==&#39;i1&#39; &amp; reactor==&#39;transfer&#39; &amp; treatment==&#39;psoralen&#39; &amp; run %in% c(4,5)), aes(x=E, y=current,color=rep,group=factor(rep)))+geom_path()+
  facet_wrap(treatment~run,scales=&#39;free&#39;)+
  scale_color_viridis()</code></pre>
<p><img src="01_17_19_psoralen_nonequil_2_Dap_processing_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" /> They look pretty clean and diminish as expected, so I’ll proceed with these for now.</p>
</div>
<div id="gc-data" class="section level2">
<h2>GC data</h2>
<p>Now let’s import the GC data for the <span class="math inline">\(D_{ap}\)</span> estimates.</p>
<pre class="r"><code>GC_file_paths &lt;-  dir(path=&#39;../Data&#39;, pattern = &quot;[GC]+.+[txt]$&quot;,recursive = T,full.names = T)

GC_filenames &lt;- basename(GC_file_paths)

gc_data_cols &lt;-  c(&#39;E&#39;,&#39;i1&#39;,&#39;i2&#39;,&#39;t&#39;)

filename_cols = c(&#39;PHZadded&#39;,&#39;treatment&#39;,&#39;reactor&#39;,&#39;run&#39;,&#39;echem&#39;,&#39;rep&#39;)

gc_skip_rows=21
  

gc_data &lt;- echem_import_to_df(filenames = GC_filenames, 
                                       file_paths = GC_file_paths, 
                                       data_cols = gc_data_cols, 
                                       skip_rows = gc_skip_rows,
                                       filename_cols = filename_cols,
                                       rep = T)</code></pre>
<p>Let’s look at all of the GCs taken during transfer:</p>
<pre class="r"><code>ggplot(gc_data %&gt;% filter(reactor==&#39;transfer&#39;), aes(x=E, y=current,color=rep,group=electrode))+
  geom_point(size=0.5)+
  facet_grid(treatment~run,scales=&#39;free&#39;)+
  scale_x_reverse() + 
  scale_color_viridis(discrete = F)</code></pre>
<p><img src="01_17_19_psoralen_nonequil_2_Dap_processing_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /> Ok, this dataset looks pretty much as expected. * The psoralen generators (top i1 lines) look a little funky, as we have seen in the past… * The first rep from each run goes down around -0.4V instead of leveling off, as we expect during the initial period of diminishing PYO concentrations. However, later on (in the control particularly) the GCs seem very symmetrical and do level off (ideal behavior).</p>
<p>Let’s zoom in on the collector data. I’m now plotting the collector data as positive:</p>
<pre class="r"><code>ggplot(gc_data %&gt;% filter(reactor==&#39;transfer&#39; &amp; electrode==&#39;i2&#39;), aes(x=E, y=-current,color=rep,group=factor(rep))) +
  geom_path()+
  facet_grid(treatment~run,scales=&#39;free&#39;)+
  scale_color_viridis()+
  scale_x_reverse()</code></pre>
<p><img src="01_17_19_psoralen_nonequil_2_Dap_processing_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /> This is the dataset I will quantify, and overall it looks pretty good! In general the signals decay smoothly as the reps go on.</p>
</div>
</div>
<div id="quantification" class="section level1">
<h1>Quantification</h1>
<div id="control-swv" class="section level2">
<h2>Control SWV</h2>
<p>First, let’s quantify the control SWVs, since they are all of similar shape and magnitude (and the psoralen data is not).</p>
<pre class="r"><code>swv_control_data &lt;- swv_data %&gt;% 
  filter(treatment==&#39;control&#39; &amp; PHZaddedInt==75)

unique_id_cols = c(&#39;PHZadded&#39;,&#39;treatment&#39;,&#39;reactor&#39;,&#39;run&#39;,&#39;echem&#39;,&#39;rep&#39;,&#39;minutes&#39;,&#39;PHZaddedInt&#39;,&#39;electrode&#39;)

swv_control_signals &lt;- echem_signal(df = swv_control_data, 
                            unique_id_cols = unique_id_cols,
                            max_interval = c(0.0,-0.4), 
                            min_interval = c(0.0,-0.4)) </code></pre>
<p>First, let’s look at the electrode 1 data, which will be used for further analysis.</p>
<pre class="r"><code>ggplot(swv_control_data %&gt;% filter(electrode==&#39;i1&#39;), 
       aes(x = E, y = current, color = rep, shape=reactor, group=factor(rep))) +
  geom_path()+
  geom_point(data = swv_control_signals %&gt;% filter(electrode==&#39;i1&#39;), 
             aes(x = E_from_maxs, y = current_from_maxs), color = &#39;red&#39;) + 
  geom_point(data = swv_control_signals %&gt;% filter(electrode==&#39;i1&#39;), 
             aes(x = E_from_mins, y = current_from_mins), color = &#39;blue&#39;) +
  facet_wrap(~run,scales=&#39;free&#39;)+
  scale_x_reverse()+
  scale_color_viridis()</code></pre>
<p><img src="01_17_19_psoralen_nonequil_2_Dap_processing_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;" /> The quantification looks pretty clean overall: * There are 2 datapoints in run 5 that appear to have max points not in the main redox peak, but let’s ignore those for now. * Interestingly, notice the differences between the soak scan and the first transfer scan (top circle/triangle). In all cases, the scans are pretty close in magnitude. For runs 1 and 4 the transfer peaks are actually slightly higher than the soak…</p>
<p>Now let’s examine the electrode 2 data, even though I don’t intend to use it right now.</p>
<pre class="r"><code>ggplot(swv_control_data %&gt;% filter(electrode==&#39;i2&#39;), 
       aes(x = E, y = current, color = rep, shape=reactor, group=factor(rep))) + 
  geom_path()+
  geom_point(data = swv_control_signals %&gt;% filter(electrode==&#39;i2&#39;), 
             aes(x = E_from_maxs, y = current_from_maxs), color = &#39;red&#39;) + 
  geom_point(data = swv_control_signals %&gt;% filter(electrode==&#39;i2&#39;), 
             aes(x = E_from_mins, y = current_from_mins), color = &#39;blue&#39;) +
  facet_wrap(~run,scales=&#39;free&#39;)+
  scale_x_reverse()+
  scale_color_viridis()</code></pre>
<p><img src="01_17_19_psoralen_nonequil_2_Dap_processing_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;" /> The quantification looks fine, and we see the same general patterns with the soak/transfer.</p>
<p>Let’s see how the signals (max - min points) actually look across the reps.</p>
<pre class="r"><code>ggplot(swv_control_signals, aes(x=rep, y=signal,shape=reactor,color=factor(run)))+geom_line()+geom_point()+
  facet_wrap(~electrode)+
  scale_color_viridis(discrete = T)</code></pre>
<p><img src="01_17_19_psoralen_nonequil_2_Dap_processing_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;" /> These signals look good and show the same patterns that we would expect from the raw data. You can see the the i2 following the GCs from runs 1-3 look very weird.</p>
</div>
<div id="psoralen-swv" class="section level2">
<h2>Psoralen SWV</h2>
<pre class="r"><code>swv_psoralen_data &lt;- swv_data %&gt;% 
  filter(treatment==&#39;psoralen&#39; &amp; PHZaddedInt==75) %&gt;% 
  filter(run %in% c(4,5))

unique_id_cols = c(&#39;PHZadded&#39;,&#39;treatment&#39;,&#39;reactor&#39;,&#39;run&#39;,&#39;echem&#39;,&#39;rep&#39;,&#39;minutes&#39;,&#39;PHZaddedInt&#39;,&#39;electrode&#39;)

swv_psoralen_signals &lt;- echem_signal(df = swv_psoralen_data, 
                            unique_id_cols = unique_id_cols,
                            max_interval = c(-0.11,-0.4), 
                            min_interval = c(-0.11,-0.4)) </code></pre>
<pre class="r"><code>ggplot(swv_psoralen_data %&gt;% filter(electrode==&#39;i1&#39;), 
       aes(x = E, y = current, color = rep, shape=reactor, group=factor(rep))) +
  geom_path()+
  geom_point(data = swv_psoralen_signals %&gt;% filter(electrode==&#39;i1&#39;), 
             aes(x = E_from_maxs, y = current_from_maxs), color = &#39;red&#39;) + 
  geom_point(data = swv_psoralen_signals %&gt;% filter(electrode==&#39;i1&#39;), 
             aes(x = E_from_mins, y = current_from_mins), color = &#39;blue&#39;) +
  facet_wrap(reactor~run,scales=&#39;free&#39;)+
  scale_x_reverse()+
  scale_color_viridis()</code></pre>
<p><img src="01_17_19_psoralen_nonequil_2_Dap_processing_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="all-gc" class="section level2">
<h2>All GC</h2>
<pre class="r"><code>gc_data_i2 &lt;- gc_data %&gt;% 
  filter(electrode==&#39;i2&#39; &amp; PHZaddedInt==75) %&gt;% 
  mutate(current=-current)

unique_id_cols = c(&#39;PHZadded&#39;,&#39;treatment&#39;,&#39;reactor&#39;,&#39;run&#39;,&#39;echem&#39;,&#39;rep&#39;,&#39;minutes&#39;,&#39;PHZaddedInt&#39;,&#39;electrode&#39;)

gc_signals &lt;- echem_signal(df = gc_data_i2, 
                            unique_id_cols = unique_id_cols,
                            max_interval = c(-0.399,-0.399), 
                            min_interval = c(0.0,-0.4)) </code></pre>
<p>Let’s look at all of the transfer gc data:</p>
<pre class="r"><code>ggplot(gc_data_i2 %&gt;% filter(reactor==&#39;transfer&#39;), 
       aes(x = E, y = current, color = rep, shape=reactor, group=factor(rep))) +
  geom_path()+
  geom_point(data = gc_signals %&gt;% filter(reactor==&#39;transfer&#39;), 
             aes(x = E_from_maxs, y = current_from_maxs), color = &#39;red&#39;) + 
  geom_point(data = gc_signals %&gt;% filter(reactor==&#39;transfer&#39;), 
             aes(x = E_from_mins, y = current_from_mins), color = &#39;blue&#39;) +
  facet_grid(treatment~run,scales=&#39;free&#39;)+
  scale_x_reverse()+
  scale_color_viridis()</code></pre>
<p><img src="01_17_19_psoralen_nonequil_2_Dap_processing_files/figure-html/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>This quantification looks reasonable. All the maxs are at the endpoints of the run and the mins are in the same regions of the plots.</p>
<p>Let’s look at the soak GCs just to see:</p>
<pre class="r"><code>ggplot(gc_data_i2 %&gt;% filter(reactor==&#39;soak&#39; &amp; rep==1), 
       aes(x = E, y = current, color = factor(run), shape=reactor, linetype=treatment)) +
  geom_path()+
  geom_point(data = gc_signals %&gt;% filter(reactor==&#39;soak&#39;), 
             aes(x = E_from_maxs, y = current_from_maxs), color = &#39;red&#39;) + 
  geom_point(data = gc_signals %&gt;% filter(reactor==&#39;soak&#39;), 
             aes(x = E_from_mins, y = current_from_mins), color = &#39;blue&#39;) +
  scale_x_reverse()+
  scale_color_viridis(discrete = T)</code></pre>
<p><img src="01_17_19_psoralen_nonequil_2_Dap_processing_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;" /> Interesting. The psoralen curves are consistently higher than the control, which may be related to the fact that there was more biomass on the control electrode, which may have effectively blocked the solution PYO more than the psoralen biofilm. Also note that these GC magnitudes are almost an order of magnitude higher than the highest transfer GCs. This is different than the SWVs and I’m not sure why. It could be because the first scan taken was an SWV, but it could also be that GC should be more sensitive to changes in <span class="math inline">\(D_{ap}\)</span> than SWV…</p>
<p>Let’s also look at the GC signals vs. rep:</p>
<pre class="r"><code>ggplot(gc_signals, aes(x = rep, y = signal,shape=reactor, color=factor(run)))+
  geom_line()+
  geom_point()+
  facet_wrap(reactor~treatment,scales=&#39;free&#39;)+
  scale_color_viridis(discrete = T)</code></pre>
<p><img src="01_17_19_psoralen_nonequil_2_Dap_processing_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="processed-datasets" class="section level1">
<h1>Processed Datasets</h1>
<div id="d_ap-swv-vs.gc" class="section level2">
<h2><span class="math inline">\(D_{ap}\)</span> SWV vs. GC</h2>
<p>Control Dataset</p>
<pre class="r"><code>swv_gc_control &lt;- left_join(swv_control_signals %&gt;% filter(run&lt;=3),gc_signals,
                            by=c(&#39;run&#39;,&#39;rep&#39;,&#39;reactor&#39;,&#39;treatment&#39;),
                            suffix=c(&#39;_from_swv&#39;,&#39;_from_gc&#39;))

write_csv(swv_gc_control,&quot;./01_17_19_swv_gc_control_dap_processed.csv&quot;)

ggplot(swv_gc_control %&gt;% filter(reactor==&#39;transfer&#39; &amp; electrode_from_swv==&#39;i1&#39; &amp; rep&gt;0), aes(x = signal_from_swv, y = signal_from_gc, color=factor(run)))+
  geom_line()+
  geom_point()+
  geom_smooth(method=&#39;lm&#39;,se=F)+
  scale_color_viridis(discrete = T)</code></pre>
<p><img src="01_17_19_psoralen_nonequil_2_Dap_processing_files/figure-html/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>swv_gc_control_lms &lt;- swv_gc_control %&gt;% 
  filter(reactor==&#39;transfer&#39; &amp; rep&gt;0 &amp; electrode_from_swv==&#39;i1&#39;) %&gt;%
  group_by(run,treatment,electrode_from_swv) %&gt;% 
  do(tidy(lm(signal_from_gc~signal_from_swv,.)))</code></pre>
<p>Psoralen dataset</p>
<pre class="r"><code>swv_gc_psoralen &lt;- left_join(swv_psoralen_signals ,gc_signals,
                            by=c(&#39;run&#39;,&#39;rep&#39;,&#39;reactor&#39;,&#39;treatment&#39;),
                            suffix=c(&#39;_from_swv&#39;,&#39;_from_gc&#39;))

write_csv(swv_gc_psoralen,&quot;./01_17_19_swv_gc_psoralen_dap_processed.csv&quot;)

ggplot(swv_gc_psoralen %&gt;% filter(reactor==&#39;transfer&#39; &amp; electrode_from_swv==&#39;i1&#39; &amp; rep&gt;0), aes(x = signal_from_swv, y = signal_from_gc, color=factor(run)))+
  geom_line()+
  geom_point()+
  scale_color_viridis(discrete = T)</code></pre>
<p><img src="01_17_19_psoralen_nonequil_2_Dap_processing_files/figure-html/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>swv_gc_psoralen_lms &lt;- swv_gc_psoralen %&gt;% 
  filter(reactor==&#39;transfer&#39; &amp; rep&gt;0) %&gt;%
  group_by(run,treatment,electrode_from_swv) %&gt;% 
  do(tidy(lm(signal_from_gc~signal_from_swv,.)))</code></pre>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
